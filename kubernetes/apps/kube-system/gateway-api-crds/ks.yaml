---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: &app gateway-api-crds
  namespace: flux-system
spec:
  commonMetadata:
    labels:
      app.kubernetes.io/name: *app
  interval: 1h
  path: ./config/crd/standard
  prune: true
  retryInterval: 2m
  sourceRef:
    kind: GitRepository
    name: gateway-api
    namespace: flux-system
  timeout: 5m
  wait: true
  patches:
    - patch: |-
        apiVersion: apiextensions.k8s.io/v1
        kind: CustomResourceDefinition
        metadata:
          name: not-used
        spec:
          versions:
            - name: v1alpha3
              served: false
              storage: false
              schema:
                openAPIV3Schema:
                  type: object
      target:
        group: apiextensions.k8s.io
        kind: CustomResourceDefinition
        labelSelector: gateway.networking.k8s.io/policy=true

