version: v1alpha1
debug: false
persist: true
machine:
  type: controlplane
  token: bfdwhi.u4zig0fvw5mj9uy8
  ca:
    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJQekNCOHFBREFnRUNBaEVBM3E1aE1iUWhZZ2RkWHEySUMvNDRQVEFGQmdNclpYQXdFREVPTUF3R0ExVUUKQ2hNRmRHRnNiM013SGhjTk1qUXdNekEzTURVMU1EVTNXaGNOTXpRd016QTFNRFUxTURVM1dqQVFNUTR3REFZRApWUVFLRXdWMFlXeHZjekFxTUFVR0F5dGxjQU1oQUtsVmUwVjVqUDc2UzQxZWFOc2liczQ0dktvaG53T05pSktxCm1FUWhSZ084bzJFd1h6QU9CZ05WSFE4QkFmOEVCQU1DQW9Rd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSEF3RUcKQ0NzR0FRVUZCd01DTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRk1ScUd6T2gzak5YMndHZwp5OS9CejVKTms4MEtNQVVHQXl0bGNBTkJBTXJNbTcyTEl4ZjZnaVpnUGx2Y05naGZGdjJJQmdCRzkzYitjaWJrCnU5dTFxUkdGd0cybUc4bUpUSUF3aUFOT2tlR2FWRDNkcWdKS1V1ZjdlbnE4endJPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    key: LS0tLS1CRUdJTiBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0KTUM0Q0FRQXdCUVlESzJWd0JDSUVJRk9KQTNaeFJBeDJOTnoxcVp2QXlibDIwWlpEeGZSbERVRmg4czltU2ZZUgotLS0tLUVORCBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0K
  certSANs:
    - 10.0.10.30
    - 127.0.0.1
    - talos.flyingfox-decibel.ts.net
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.34.1
    extraArgs:
      image-gc-high-threshold: "55"
      image-gc-low-threshold: "50"
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 10.0.10.0/24
    disableManifestsDirectory: true
  network:
    hostname: talos-cp-01
    interfaces:
      - interface: eth0
        addresses:
          - 10.0.10.31/24
        routes:
          - network: 0.0.0.0/0
            gateway: 10.0.10.1
        mtu: 1500
        dhcp: false
        vip:
          ip: 10.0.10.30
    disableSearchDomain: true
  install:
    disk: /dev/mmcblk0
    extraKernelArgs:
      - net.ifnames=0
    image: factory.talos.dev/installer/cf9001404ecb05308d6e7c4c945a5e7d84013d86eda6e604d69c9167380c4084:v1.7.5
    wipe: false
  files:
    - content: |-
        [plugins."io.containerd.grpc.v1.cri"]
          enable_unprivileged_ports = true
          enable_unprivileged_icmp = true
        [plugins."io.containerd.grpc.v1.cri".containerd]
          discard_unpacked_layers = false
        [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
          discard_unpacked_layers = false
      permissions: 0o0
      path: /etc/cri/conf.d/20-customization.part
      op: create
  time:
    disabled: false
    servers:
      - ntp1.wiktel.com
      - ntp2.wiktel.com
      - time.cloudflare.com
  sysctls:
    fs.inotify.max_queued_events: "65536"
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "524288"
    net.core.rmem_max: "2500000"
    net.core.wmem_max: "2500000"
  features:
    rbac: true
    stableHostname: true
    kubernetesTalosAPIAccess:
      enabled: true
      allowedRoles:
        - os:admin
      allowedKubernetesNamespaces:
        - system-upgrade
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
  nodeLabels:
    openebs.io/engine: mayastor
cluster:
  id: wRcoS9HpZS3trhkOrwnx6_7709HofSltMZ6_oAEApTQ=
  secret: xaP/SINjxQMyLvIpmI+HQ4w1A3GJ15liQX7dSz2RBC0=
  controlPlane:
    endpoint: https://10.0.10.30:6443
  clusterName: home-kubernetes
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.69.0.0/16
    serviceSubnets:
      - 10.96.0.0/16
  token: pctyd8.s2omn3ie4gcuczm1
  secretboxEncryptionSecret: LBBF69QJe+XBECmPuAkTJAyTrcXnWWPIlPB9ueqeakc=
  ca:
    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJpakNDQVMrZ0F3SUJBZ0lRSjhGaXhKdkdrRStEYUNZdDdBdURwVEFLQmdncWhrak9QUVFEQWpBVk1STXcKRVFZRFZRUUtFd3ByZFdKbGNtNWxkR1Z6TUI0WERUSTBNRE13TnpBMU5UQTFOMW9YRFRNME1ETXdOVEExTlRBMQpOMW93RlRFVE1CRUdBMVVFQ2hNS2EzVmlaWEp1WlhSbGN6QlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VICkEwSUFCTlRFVmlMYUZpVnJ4L25wSVVCSVVkK3hmQWtYMXJ6MFE1YVVBeWxHN0QzY0d1WmZNWGRCdFBHK1NCZ0oKMmd6UkNoaFNMQVo1cGpyV0JsdXlUUGdnTWpLallUQmZNQTRHQTFVZER3RUIvd1FFQXdJQ2hEQWRCZ05WSFNVRQpGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFCkZnUVV3dGFNRk5sbDcyaGUxVEhEZFRJWXE1cmlFSDR3Q2dZSUtvWkl6ajBFQXdJRFNRQXdSZ0loQUlQK3p5enkKZ3hVbmVFazlvV0wzMUUrWnVRaE1na05MUHlxbmU4aWVsT2dXQWlFQTd3NlZDampVcEwrS1k4VTZRYm11YWtFUwplRlU0ZHFUNGlaU043OEVQR2hVPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSU1aT2orRzZEVDg5K2FhZkVvY01ZOFBhRUw4d1dUY3BYVzhuV1hvOWZFZEFvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFMU1SV0l0b1dKV3ZIK2VraFFFaFIzN0Y4Q1JmV3ZQUkRscFFES1Vic1Bkd2E1bDh4ZDBHMAo4YjVJR0FuYURORUtHRklzQm5tbU90WUdXN0pNK0NBeU1nPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
  aggregatorCA:
    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJYakNDQVFXZ0F3SUJBZ0lRYTlSSmJxS2hJMjlGOWk3MFFoWHVjekFLQmdncWhrak9QUVFEQWpBQU1CNFgKRFRJME1ETXdOekExTlRBMU4xb1hEVE0wTURNd05UQTFOVEExTjFvd0FEQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxRwpTTTQ5QXdFSEEwSUFCRStFRTNmZ2crdDY5aXRoMDVhR3F0Smhlam90Z3V0TWlXWlBEVDVVZWM3K2RJS25ZVGlKCjJyaW90SnZmaFB4ZkliazhKNm03SDZBZXJmdmxJaG5iVWtHallUQmZNQTRHQTFVZER3RUIvd1FFQXdJQ2hEQWQKQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZApCZ05WSFE0RUZnUVV1amprYmg4YjVMRUQzdGhleFJMa05YKzJIbGd3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnCmUxRi84WWluQUJ6RzNGa21lNG5ScTJLK3V2UWZHZFlMVHdoUFcrMGt1MGNDSUd2RzRlRDcyL050aElyWHd0UXgKL3JMSnhoL2tXNWlOMzlKRGtLeEpUcjJSCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSVArM2x4WWEwTUVsTDdEelBmK1FkVitjTTFvYVQxMUdmRTBRNzY4c280VXVvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFVDRRVGQrQ0Q2M3IySzJIVGxvYXEwbUY2T2kyQzYweUpaazhOUGxSNXp2NTBncWRoT0luYQp1S2kwbTkrRS9GOGh1VHducWJzZm9CNnQrK1VpR2R0U1FRPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
  serviceAccount:
    key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUlmRGFqTGVReXBIZTFueEpMazdsWDV5Q0FiWWRYbUNHUHYwTlNNRlRLR2xvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFK090UWtGd29PS2ptZW5UbnZjUlZldFRSbUEyRDFxRUhBOUFzaHdlZFp5WnFBQWtKVm03OApEdHRRK1VJUFBjYUZOUGIwL2o3MkplME9xUkFzMkdxcFF3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
  apiServer:
    image: registry.k8s.io/kube-apiserver:v1.34.1
    certSANs:
      - 10.0.10.30
      - 10.0.10.30
      - 127.0.0.1
      - talos.flyingfox-decibel.ts.net
    disablePodSecurityPolicy: true
    auditPolicy:
      apiVersion: audit.k8s.io/v1
      kind: Policy
      rules:
        - level: Metadata
  controllerManager:
    image: registry.k8s.io/kube-controller-manager:v1.34.1
    extraArgs:
      bind-address: 0.0.0.0
  proxy:
    disabled: true
    image: registry.k8s.io/kube-proxy:v1.34.1
  scheduler:
    image: registry.k8s.io/kube-scheduler:v1.34.1
    extraArgs:
      bind-address: 0.0.0.0
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
  etcd:
    ca:
      crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJmakNDQVNTZ0F3SUJBZ0lSQUx0QmpmTDZPdk5aeXluaytQbklRc293Q2dZSUtvWkl6ajBFQXdJd0R6RU4KTUFzR0ExVUVDaE1FWlhSalpEQWVGdzB5TkRBek1EY3dOVFV3TlRkYUZ3MHpOREF6TURVd05UVXdOVGRhTUE4eApEVEFMQmdOVkJBb1RCR1YwWTJRd1dUQVRCZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFTWnBjRFlpZm1KCks4dyt1VGIrZGlFa3Y1TURoS3FIMUZLOGJqUVZ0UCtCRnMrMXh2UjQzWTNFQ3ZkS28yK2ovdG5YcldwMnBGbGwKQUJtZHJ0MDMrQ1U3bzJFd1h6QU9CZ05WSFE4QkFmOEVCQU1DQW9Rd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSApBd0VHQ0NzR0FRVUZCd01DTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRkQybmhDcHQrWWFjCktSY00xVVpjSzBQY1gwaUNNQW9HQ0NxR1NNNDlCQU1DQTBnQU1FVUNJRllxeTdHZDBTNmZheDNhVCtOMXdmbWQKNlhCSmlwenBzdFdFYlpteWR2d21BaUVBanBJR2lsK0JjeFVjWm90UGVGM1NsOXFIaFU1dDBMeld0QnphOUcvNQpRYWM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
      key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSU91TmRoZlNTU2l5TGttM1RFaU1McUtpK3c0UzRTSHBOOGI5UWtUaEpGL0RvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFbWFYQTJJbjVpU3ZNUHJrMi9uWWhKTCtUQTRTcWg5UlN2RzQwRmJUL2dSYlB0Y2IwZU4yTgp4QXIzU3FOdm8vN1oxNjFxZHFSWlpRQVpuYTdkTi9nbE93PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
    extraArgs:
      listen-metrics-urls: http://0.0.0.0:2381
    advertisedSubnets:
      - 10.0.10.0/24
  allowSchedulingOnMasters: false
